Preparing data loaders...
Initializing model...
2025-12-06 18:08:09,025 - INFO - Start training for 20 epochs on mps...
Epoch 1 [Train]:   0%|                                                                  | 0/68 [00:00<?, ?it/s]/Users/wadarei/2WINS_AI_test/.venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
2025-12-06 18:54:55,429 - INFO - Epoch 1/20 | Train Loss: 0.6800 | Val Loss: 0.5655 | Recall: 0.8857 | Precision: 0.4559 | F1: 0.6019 | Time: 2806.40s
2025-12-06 18:54:55,440 - INFO - Recall Improved (0.0000 -> 0.8857). Saving model...
Epoch 2 [Train]:   0%|                                                                  | 0/68 [00:00<?, ?it/s]/Users/wadarei/2WINS_AI_test/.venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
2025-12-06 19:45:28,719 - INFO - Epoch 2/20 | Train Loss: 0.6509 | Val Loss: 0.7179 | Recall: 0.4143 | Precision: 1.0000 | F1: 0.5859 | Time: 3032.98s
Epoch 3 [Train]:   0%|                                                                  | 0/68 [00:00<?, ?it/s]/Users/wadarei/2WINS_AI_test/.venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
2025-12-06 20:28:47,847 - INFO - Epoch 3/20 | Train Loss: 0.5843 | Val Loss: 0.6387 | Recall: 0.4143 | Precision: 0.9355 | F1: 0.5743 | Time: 2599.12s
Epoch 4 [Train]:   0%|                                                                  | 0/68 [00:00<?, ?it/s]/Users/wadarei/2WINS_AI_test/.venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
2025-12-06 21:10:07,833 - INFO - Epoch 4/20 | Train Loss: 0.5673 | Val Loss: 0.3682 | Recall: 0.8571 | Precision: 0.6452 | F1: 0.7362 | Time: 2479.98s
Epoch 5 [Train]:   0%|                                                                  | 0/68 [00:00<?, ?it/s]/Users/wadarei/2WINS_AI_test/.venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
Epoch 5 [Train]:  26%|███████████▋                                | 18/68 [11:39<30:56, 37.12s/it, loss=1.0671]Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x1063d8f40>
Traceback (most recent call last):
  File "/Users/wadarei/2WINS_AI_test/.venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 1654, in __del__
    self._shutdown_workers()
  File "/Users/wadarei/2WINS_AI_test/.venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 1618, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/popen_fork.py", line 41, in wait
    if not wait([self.sentinel], timeout):
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/connection.py", line 1148, in wait
    ready = selector.select(timeout)
  File "/opt/homebrew/Cellar/python@3.13/3.13.3/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt:
Traceback (most recent call last):                                                                             
  File "/Users/wadarei/2WINS_AI_test/main.py", line 113, in <module>
    main()
    ~~~~^^
  File "/Users/wadarei/2WINS_AI_test/main.py", line 107, in main
    trainer.fit(num_epochs=cfg.epochs)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wadarei/2WINS_AI_test/src/trainer.py", line 161, in fit
    train_loss = self.train_one_epoch(epoch)
  File "/Users/wadarei/2WINS_AI_test/src/trainer.py", line 88, in train_one_epoch
    loss.backward()
    ~~~~~~~~~~~~~^^
  File "/Users/wadarei/2WINS_AI_test/.venv/lib/python3.13/site-packages/torch/_tensor.py", line 625, in backward
    torch.autograd.backward(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        self, gradient, retain_graph, create_graph, inputs=inputs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/wadarei/2WINS_AI_test/.venv/lib/python3.13/site-packages/torch/autograd/__init__.py", line 354, in backward
    _engine_run_backward(
    ~~~~~~~~~~~~~~~~~~~~^
        tensors,
        ^^^^^^^^
    ...<5 lines>...
        accumulate_grad=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/wadarei/2WINS_AI_test/.venv/lib/python3.13/site-packages/torch/autograd/graph.py", line 841, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        t_outputs, *args, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )  # Calls into the C++ engine to run the backward pass
    ^
KeyboardInterrupt
